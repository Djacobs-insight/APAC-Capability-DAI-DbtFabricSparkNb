[{"namespace":"lh_raw","tableName":"application_cities","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_raw\nTable: application_cities\nOwner: trusted-service-user\nCreated Time: Mon Jun 10 04:41:54 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.2.1-SNAPSHOT\nType: MANAGED\nProvider: delta\nTable Properties: [trident.autodiscovered.table=true]\nLocation: abfss:\/\/fd928fdf-36de-4598-918e-866dba774473@onelake.dfs.fabric.microsoft.com\/0dd634b3-06c6-4ba3-9275-e26fe75d7d97\/Tables\/application_cities\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nPartition Provider: Catalog\n"},{"namespace":"lh_raw","tableName":"application_countries","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_raw\nTable: application_countries\nOwner: trusted-service-user\nCreated Time: Mon Jun 10 04:42:05 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.2.1-SNAPSHOT\nType: MANAGED\nProvider: delta\nTable Properties: [trident.autodiscovered.table=true]\nLocation: abfss:\/\/fd928fdf-36de-4598-918e-866dba774473@onelake.dfs.fabric.microsoft.com\/0dd634b3-06c6-4ba3-9275-e26fe75d7d97\/Tables\/application_countries\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nPartition Provider: Catalog\n"},{"namespace":"lh_raw","tableName":"application_deliverymethods","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_raw\nTable: application_deliverymethods\nOwner: trusted-service-user\nCreated Time: Mon Jun 10 04:42:21 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.2.1-SNAPSHOT\nType: MANAGED\nProvider: delta\nTable Properties: [trident.autodiscovered.table=true]\nLocation: abfss:\/\/fd928fdf-36de-4598-918e-866dba774473@onelake.dfs.fabric.microsoft.com\/0dd634b3-06c6-4ba3-9275-e26fe75d7d97\/Tables\/application_deliverymethods\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nPartition Provider: Catalog\n"},{"namespace":"lh_raw","tableName":"application_people","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_raw\nTable: application_people\nOwner: trusted-service-user\nCreated Time: Mon Jun 10 04:42:31 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.2.1-SNAPSHOT\nType: MANAGED\nProvider: delta\nTable Properties: [trident.autodiscovered.table=true]\nLocation: abfss:\/\/fd928fdf-36de-4598-918e-866dba774473@onelake.dfs.fabric.microsoft.com\/0dd634b3-06c6-4ba3-9275-e26fe75d7d97\/Tables\/application_people\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nPartition Provider: Catalog\n"},{"namespace":"lh_raw","tableName":"application_stateprovinces","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_raw\nTable: application_stateprovinces\nOwner: trusted-service-user\nCreated Time: Mon Jun 10 04:42:47 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.2.1-SNAPSHOT\nType: MANAGED\nProvider: delta\nTable Properties: [trident.autodiscovered.table=true]\nLocation: abfss:\/\/fd928fdf-36de-4598-918e-866dba774473@onelake.dfs.fabric.microsoft.com\/0dd634b3-06c6-4ba3-9275-e26fe75d7d97\/Tables\/application_stateprovinces\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nPartition Provider: Catalog\n"},{"namespace":"lh_raw","tableName":"sales_buyinggroups","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_raw\nTable: sales_buyinggroups\nOwner: trusted-service-user\nCreated Time: Mon Jun 10 04:43:03 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.2.1-SNAPSHOT\nType: MANAGED\nProvider: delta\nTable Properties: [trident.autodiscovered.table=true]\nLocation: abfss:\/\/fd928fdf-36de-4598-918e-866dba774473@onelake.dfs.fabric.microsoft.com\/0dd634b3-06c6-4ba3-9275-e26fe75d7d97\/Tables\/sales_buyinggroups\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nPartition Provider: Catalog\n"},{"namespace":"lh_raw","tableName":"sales_customercategories","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_raw\nTable: sales_customercategories\nOwner: trusted-service-user\nCreated Time: Mon Jun 10 04:43:14 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.2.1-SNAPSHOT\nType: MANAGED\nProvider: delta\nTable Properties: [trident.autodiscovered.table=true]\nLocation: abfss:\/\/fd928fdf-36de-4598-918e-866dba774473@onelake.dfs.fabric.microsoft.com\/0dd634b3-06c6-4ba3-9275-e26fe75d7d97\/Tables\/sales_customercategories\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nPartition Provider: Catalog\n"},{"namespace":"lh_raw","tableName":"sales_customers","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_raw\nTable: sales_customers\nOwner: trusted-service-user\nCreated Time: Mon Jun 10 04:43:24 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.2.1-SNAPSHOT\nType: MANAGED\nProvider: delta\nTable Properties: [trident.autodiscovered.table=true]\nLocation: abfss:\/\/fd928fdf-36de-4598-918e-866dba774473@onelake.dfs.fabric.microsoft.com\/0dd634b3-06c6-4ba3-9275-e26fe75d7d97\/Tables\/sales_customers\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nPartition Provider: Catalog\n"},{"namespace":"lh_raw","tableName":"sales_invoicelines","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_raw\nTable: sales_invoicelines\nOwner: trusted-service-user\nCreated Time: Mon Jun 10 04:43:35 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.2.1-SNAPSHOT\nType: MANAGED\nProvider: delta\nTable Properties: [trident.autodiscovered.table=true]\nLocation: abfss:\/\/fd928fdf-36de-4598-918e-866dba774473@onelake.dfs.fabric.microsoft.com\/0dd634b3-06c6-4ba3-9275-e26fe75d7d97\/Tables\/sales_invoicelines\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nPartition Provider: Catalog\n"},{"namespace":"lh_raw","tableName":"sales_invoices","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_raw\nTable: sales_invoices\nOwner: trusted-service-user\nCreated Time: Mon Jun 10 04:43:46 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.2.1-SNAPSHOT\nType: MANAGED\nProvider: delta\nTable Properties: [trident.autodiscovered.table=true]\nLocation: abfss:\/\/fd928fdf-36de-4598-918e-866dba774473@onelake.dfs.fabric.microsoft.com\/0dd634b3-06c6-4ba3-9275-e26fe75d7d97\/Tables\/sales_invoices\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nPartition Provider: Catalog\n"},{"namespace":"lh_raw","tableName":"dates","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_raw\nTable: dates\nOwner: trusted-service-user\nCreated Time: Mon Jun 10 20:52:19 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.2.1-SNAPSHOT\nType: MANAGED\nProvider: delta\nTable Properties: [trident.autodiscovered.table=true]\nLocation: abfss:\/\/fd928fdf-36de-4598-918e-866dba774473@onelake.dfs.fabric.microsoft.com\/0dd634b3-06c6-4ba3-9275-e26fe75d7d97\/Tables\/dates\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nPartition Provider: Catalog\n"},{"namespace":"lh_consolidated","tableName":"cd_fact_sales","isTemporary":false,"information":"Catalog: spark_catalog\nDatabase: lh_consolidated\nTable: cd_fact_sales\nOwner: trusted-service-user\nCreated Time: Mon Jun 17 19:32:47 UTC 2024\nLast Access: UNKNOWN\nCreated By: Spark 3.4.1.5.3.20240428.1\nType: VIEW\nView Text: with source_data as (\nselect \na.CustomerID as CustomerKey,\na.BillToCustomerID as BillToCustomerKey,\na.DeliveryMethodID as DeliveryMethodKey,\na.OrderID,\na.InvoiceID,\nb.InvoiceLineID,\na.SalespersonPersonID as SalespersonPersonID,\nreplace(cast(a.InvoiceDate as date),'-', '') as InvoiceDateKey,\na.CustomerPurchaseOrderNumber,\na.IsCreditNote,\na.CreditNoteReason,\nb.StockItemID as StockItemKey,\nb.Quantity,\nb.UnitPrice,\nb.TaxRate,\nb.TaxAmount,\nb.LineProfit,\nb.ExtendedPrice,\nb.Quantity * b.UnitPrice as SalesAmount,\nrow_number () over (\n    partition by \n    a.CustomerID,\n    a.BillToCustomerID,\n    a.DeliveryMethodID,\n    a.OrderID,\n    a.InvoiceID,\n    b.InvoiceLineID,\n    a.SalespersonPersonID,\n    a.InvoiceDate,\n    a.CustomerPurchaseOrderNumber,\n    a.IsCreditNote,\n    a.CreditNoteReason,\n    b.StockItemID,\n    b.Quantity,\n    b.UnitPrice,\n    b.TaxRate,\n    b.TaxAmount,\n    b.LineProfit,\n    b.ExtendedPrice\n    order by\n    a.ETL_Date desc,\n    b.ETL_Date desc\n    ) as LatestRecord\nfrom lh_conformed.cf_sales_invoicelines b\njoin lh_conformed.cf_sales_invoices a\n on a.InvoiceID = b.InvoiceID\n)\nselect \n    CustomerKey,\n    BillToCustomerKey,\n    DeliveryMethodKey,\n    OrderID,\n    InvoiceID,\n    InvoiceLineID,\n    SalespersonPersonID,\n    InvoiceDateKey,\n    CustomerPurchaseOrderNumber,\n    IsCreditNote,\n    CreditNoteReason,\n    StockItemKey,\n    Quantity,\n    UnitPrice,\n    TaxRate,\n    TaxAmount,\n    LineProfit,\n    ExtendedPrice,\n    SalesAmount\nfrom source_data\nwhere LatestRecord = 1\nView Original Text: with source_data as (\nselect \na.CustomerID as CustomerKey,\na.BillToCustomerID as BillToCustomerKey,\na.DeliveryMethodID as DeliveryMethodKey,\na.OrderID,\na.InvoiceID,\nb.InvoiceLineID,\na.SalespersonPersonID as SalespersonPersonID,\nreplace(cast(a.InvoiceDate as date),'-', '') as InvoiceDateKey,\na.CustomerPurchaseOrderNumber,\na.IsCreditNote,\na.CreditNoteReason,\nb.StockItemID as StockItemKey,\nb.Quantity,\nb.UnitPrice,\nb.TaxRate,\nb.TaxAmount,\nb.LineProfit,\nb.ExtendedPrice,\nb.Quantity * b.UnitPrice as SalesAmount,\nrow_number () over (\n    partition by \n    a.CustomerID,\n    a.BillToCustomerID,\n    a.DeliveryMethodID,\n    a.OrderID,\n    a.InvoiceID,\n    b.InvoiceLineID,\n    a.SalespersonPersonID,\n    a.InvoiceDate,\n    a.CustomerPurchaseOrderNumber,\n    a.IsCreditNote,\n    a.CreditNoteReason,\n    b.StockItemID,\n    b.Quantity,\n    b.UnitPrice,\n    b.TaxRate,\n    b.TaxAmount,\n    b.LineProfit,\n    b.ExtendedPrice\n    order by\n    a.ETL_Date desc,\n    b.ETL_Date desc\n    ) as LatestRecord\nfrom lh_conformed.cf_sales_invoicelines b\njoin lh_conformed.cf_sales_invoices a\n on a.InvoiceID = b.InvoiceID\n)\nselect \n    CustomerKey,\n    BillToCustomerKey,\n    DeliveryMethodKey,\n    OrderID,\n    InvoiceID,\n    InvoiceLineID,\n    SalespersonPersonID,\n    InvoiceDateKey,\n    CustomerPurchaseOrderNumber,\n    IsCreditNote,\n    CreditNoteReason,\n    StockItemKey,\n    Quantity,\n    UnitPrice,\n    TaxRate,\n    TaxAmount,\n    LineProfit,\n    ExtendedPrice,\n    SalesAmount\nfrom source_data\nwhere LatestRecord = 1\nView Catalog and Namespace: spark_catalog.lh_consolidated\nView Query Output Columns: [CustomerKey, BillToCustomerKey, DeliveryMethodKey, OrderID, InvoiceID, InvoiceLineID, SalespersonPersonID, InvoiceDateKey, CustomerPurchaseOrderNumber, IsCreditNote, CreditNoteReason, StockItemKey, Quantity, UnitPrice, TaxRate, TaxAmount, LineProfit, ExtendedPrice, SalesAmount]\nTable Properties: [transient_lastDdlTime=1718652767]\nSerde Library: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\nInputFormat: org.apache.hadoop.mapred.SequenceFileInputFormat\nOutputFormat: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat\nStorage Properties: [serialization.format=1]\nSchema: root\n |-- CustomerKey: integer (nullable = true)\n |-- BillToCustomerKey: integer (nullable = true)\n |-- DeliveryMethodKey: integer (nullable = true)\n |-- OrderID: integer (nullable = true)\n |-- InvoiceID: integer (nullable = true)\n |-- InvoiceLineID: integer (nullable = true)\n |-- SalespersonPersonID: integer (nullable = true)\n |-- InvoiceDateKey: string (nullable = true)\n |-- CustomerPurchaseOrderNumber: integer (nullable = true)\n |-- IsCreditNote: boolean (nullable = true)\n |-- CreditNoteReason: string (nullable = true)\n |-- StockItemKey: integer (nullable = true)\n |-- Quantity: integer (nullable = true)\n |-- UnitPrice: double (nullable = true)\n |-- TaxRate: double (nullable = true)\n |-- TaxAmount: double (nullable = true)\n |-- LineProfit: double (nullable = true)\n |-- ExtendedPrice: double (nullable = true)\n |-- SalesAmount: double (nullable = true)\n\n"}]